<odoo>
    <template id="test_report_id_print">
        <t t-call="web.html_container">
            <t t-call="web.external_layout">
                <div class="page">
                    <div class="oe_structure"/>
                    <div>
                        <div class="page">
                            <div class="oe_structure"/>
                            <div class="text-center">
                                <h3>Aged Payable/Receivable</h3>
                            </div>
                            <div class="row">
                                <table class="table table-sm" name="account_lines_table" style="border-bottom:1px solid black;">
                                    <thead>
                                        <tr>
                                            <th>
                                                Customer
                                            </th>
                                            <th>
                                                <span>Report Date</span>
                                            </th>
                                            <th>
                                                <span>Journal</span>
                                            </th>
                                            <th>
                                                <span>Account</span>
                                            </th>
                                            <th>
                                                <span>Order Booker</span>
                                            </th>
                                            <th>
                                                <span>EXP. Date</span>
                                            </th>
                                            <th>
                                                As of:
                                                <span t-esc="context_timestamp(datetime.datetime.now()).strftime('%d/%m/%Y')"/>
                                            </th>
                                            <th>
                                                <strong>1 - 30</strong>
                                            </th>
                                            <th>
                                                <strong>31 - 60</strong>
                                            </th>
                                            <th>
                                                <strong>61 - 90</strong>
                                            </th>
                                            <th>
                                                <strong>91 - 120</strong>
                                            </th>
                                            <th>
                                                <strong>Older</strong>
                                            </th>
                                            <th>
                                                <strong>Total</strong>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <t t-foreach="partners" t-as="partner">
                                            <t t-if="partner">
                                                <t t-set="current_invoices" t-value="docs.get_current_invoices(partner, 'current')"/>
                                                <t t-set="oneto30" t-value="docs.get_current_invoices(partner, 'oneto30')"/>
                                                <t t-set="tto60" t-value="docs.get_current_invoices(partner, 'tto60')"/>
                                                <t t-set="tto90" t-value="docs.get_current_invoices(partner, 'tto90')"/>
                                                <t t-set="tto120" t-value="docs.get_current_invoices(partner, 'tto120')"/>
                                                <t t-set="older" t-value="docs.get_current_invoices(partner, 'older')"/>
                                                <t t-set="total_current" t-value="0"/>
                                                <t t-set="total_oneto30" t-value="0"/>
                                                <t t-set="total_tto60" t-value="0"/>
                                                <t t-set="total_tto90" t-value="0"/>
                                                <t t-set="total_tto120" t-value="0"/>
                                                <t t-set="total_older" t-value="0"/>
                                                <!--                                                <t t-set="total_current" t-value="0"/>-->
                                                <t t-if="current_invoices or oneto30 or tto60 or tto120 or older">
                                                    <tr style="font-weight:bold; background-color:#d4d4d4;">
                                                        <td style="text-align:left;" colspan="12">
                                                            <t t-esc="partner.name"/>
                                                        </td>
                                                    </tr>
                                                </t>

                                                <t t-foreach="current_invoices" t-as="o">
                                                    <t t-if="current_invoices">
                                                        <tr>
                                                            <td style="text-align:left;">
                                                                <!--                                                            <t t-esc="o['partner_id']['name']"/>-->
                                                            </td>
                                                            <td style="text-align:left;">
                                                                <t t-esc="o['date']"/>
                                                            </td>
                                                            <td style="text-align:left;">
                                                                <t t-esc="o['journal_id']['name']"/>
                                                            </td>
                                                            <td style="text-align:left;">
                                                                <t t-esc="o['account_id']['user_type_id']['name']"/>
                                                            </td>
                                                            <td style="text-align:left;">
                                                                <t t-esc="o['move_id']['order_booker_id']['name']"/>
                                                            </td>
                                                            <td style="text-align:left;">
                                                                <t t-esc="o['date_maturity']"/>
                                                            </td>
                                                            <t t-set="total_current" t-value="total_current + o['move_id']['amount_total']"/>
                                                            <td style="text-align:left;">
                                                                <t t-esc="o['move_id']['amount_total']"/>
                                                            </td>
                                                            <td style="text-align:left;">
                                                                <t t-esc="0"/>
                                                            </td>
                                                            <td style="text-align:left;">
                                                                <t t-esc="0"/>
                                                            </td>
                                                            <td style="text-align:left;">
                                                                <t t-esc="0"/>
                                                            </td>
                                                            <td style="text-align:left;">
                                                                <t t-esc="0"/>
                                                            </td>
                                                            <td style="text-align:left;">
                                                                <t t-esc="0"/>
                                                            </td>
                                                            <td style="text-align:left;">
                                                                <t t-esc="sum([o.move_id.amount_total for o in current_invoices])"/>
                                                            </td>
                                                        </tr>
                                                    </t>
                                                </t>

                                                <t t-foreach="oneto30" t-as="o">
                                                    <t t-if="oneto30">
                                                        <tr>
                                                            <td style="text-align:left;">
                                                                <!--                                                                <t t-esc="o['partner_id']['name']"/>-->
                                                            </td>
                                                            <td style="text-align:left;">
                                                                <t t-esc="o['date']"/>
                                                            </td>
                                                            <td style="text-align:left;">
                                                                <t t-esc="o['journal_id']['name']"/>
                                                            </td>
                                                            <td style="text-align:left;">
                                                                <t t-esc="o['account_id']['user_type_id']['name']"/>
                                                            </td>
                                                            <td style="text-align:left;">
                                                                <t t-esc="o['move_id']['order_booker_id']['name']"/>
                                                            </td>
                                                            <td style="text-align:left;">
                                                                <t t-esc="o['date_maturity']"/>
                                                            </td>
                                                            <td style="text-align:left;">
                                                                <t t-esc="0"/>
                                                            </td>
                                                            <t t-set="total_oneto30" t-value="total_oneto30 + o['move_id']['amount_total']"/>
                                                            <td style="text-align:left;">
                                                                <t t-esc="o['move_id']['amount_total']"/>
                                                            </td>
                                                            <td style="text-align:left;">
                                                                <t t-esc="0"/>
                                                            </td>
                                                            <td style="text-align:left;">
                                                                <t t-esc="0"/>
                                                            </td>
                                                            <td style="text-align:left;">
                                                                <t t-esc="0"/>
                                                            </td>
                                                            <td style="text-align:left;">
                                                                <t t-esc="0"/>
                                                            </td>
                                                            <td style="text-align:left;">
                                                                <t t-esc="sum([o.move_id.amount_total for o in oneto30])"/>
                                                            </td>
                                                        </tr>
                                                    </t>
                                                </t>
                                            </t>

                                            <t t-foreach="tto60" t-as="o">
                                                <t t-if="tto60">
                                                    <tr>
                                                        <td style="text-align:left;">
                                                            <!--                                                            <t t-esc="o['partner_id']['name']"/>-->
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="o['date']"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="o['journal_id']['name']"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="o['account_id']['user_type_id']['name']"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                                <t t-esc="o['move_id']['order_booker_id']['name']"/>
                                                            </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="o['date_maturity']"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="0"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="0"/>
                                                        </td>
                                                        <t t-set="total_tto60" t-value="total_tto60 + o['move_id']['amount_total']"/>
                                                        <td style="text-align:left;">
                                                            <t t-esc="o['move_id']['amount_total']"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="0"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="0"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="0"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="sum([o.move_id.amount_total for o in tto60])"/>
                                                        </td>
                                                    </tr>
                                                </t>
                                            </t>

                                            <t t-foreach="tto90" t-as="o">
                                                <t t-if="tto90">
                                                    <tr>
                                                        <td style="text-align:left;">
                                                            <!--                                                            <t t-esc="o['partner_id']['name']"/>-->
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="o['date']"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="o['journal_id']['name']"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="o['account_id']['user_type_id']['name']"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                                <t t-esc="o['move_id']['order_booker_id']['name']"/>
                                                            </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="o['date_maturity']"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="0"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="0"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="0"/>
                                                        </td>
                                                        <t t-set="total_tto90" t-value="total_tto90 + o['move_id']['amount_total']"/>
                                                        <td style="text-align:left;">
                                                            <t t-esc="o['move_id']['amount_total']"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="0"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="0"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="sum([o.move_id.amount_total for o in tto90])"/>
                                                        </td>
                                                    </tr>
                                                </t>
                                            </t>

                                            <t t-foreach="tto120" t-as="o">
                                                <t t-if="tto120">
                                                    <tr>
                                                        <td style="text-align:left;">
                                                            <!--                                                            <t t-esc="o['partner_id']['name']"/>-->
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="o['date']"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="o['journal_id']['name']"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="o['account_id']['user_type_id']['name']"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                                <t t-esc="o['move_id']['order_booker_id']['name']"/>
                                                            </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="o['date_maturity']"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="0"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="0"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="0"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="0"/>
                                                        </td>
                                                        <t t-set="total_tto120" t-value="total_tto120 + o['move_id']['amount_total']"/>
                                                        <td style="text-align:left;">
                                                            <t t-esc="o['move_id']['amount_total']"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="0"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="sum([o.move_id.amount_total for o in tto120])"/>
                                                        </td>
                                                    </tr>
                                                </t>
                                            </t>

                                            <t t-foreach="older" t-as="o">
                                                <t t-if="older">
                                                    <tr>
                                                        <td style="text-align:left;">
                                                            <!--                                                            <t t-esc="o['partner_id']['name']"/>-->
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="o['date']"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="o['journal_id']['name']"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="o['account_id']['user_type_id']['name']"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                                <t t-esc="o['move_id']['order_booker_id']['name']"/>
                                                            </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="o['date_maturity']"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="0"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="0"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="0"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="0"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="0"/>
                                                        </td>
                                                        <t t-set="total_older" t-value="total_older + o['move_id']['amount_total']"/>
                                                        <td style="text-align:left;">
                                                            <t t-esc="o['move_id']['amount_total']"/>
                                                        </td>
                                                        <td style="text-align:left;">
                                                            <t t-esc="sum([o.move_id.amount_total for o in older])"/>
                                                        </td>
                                                    </tr>
                                                </t>
                                                </t>
                                            <t t-if="total_current or total_tto30 or total_tto60 or total_tto120 or total_tto90 or total_older">
                                                <tr>
                                                    <td colspan="6" style="text-align:left;font-weight:bold;">
                                                        <span>Total</span>
                                                    </td>
                                                    <td style="text-align:left;font-weight:bold;">
                                                        <t t-esc="total_current"/>
                                                    </td>
                                                    <td style="text-align:left;font-weight:bold;">
                                                        <t t-esc="total_oneto30"/>
                                                    </td>
                                                    <td style="text-align:left;font-weight:bold;">
                                                        <t t-esc="total_tto60"/>
                                                    </td>
                                                    <td style="text-align:left;font-weight:bold;">
                                                        <t t-esc="total_tto90"/>
                                                    </td>
                                                    <td style="text-align:left;font-weight:bold;">
                                                        <t t-esc="total_tto120"/>
                                                    </td>
                                                    <td style="text-align:left;font-weight:bold;">
                                                        <t t-esc="total_older"/>
                                                    </td>

                                                </tr>
                                            </t>

                                        </t>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </t>
        </t>
    </template>
</odoo>